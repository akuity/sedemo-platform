# secret created by ESO, pushed into app specific namespace for use by kargo cred job
apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: kargo-admin-creds
spec:
  refreshInterval: 1h # How often to refresh the secret from AWS Secrets Manager
  # our actual secret store is in EKS cluster default NS
  secretStoreRef:
    name: aws-secretsmanager
    kind: ClusterSecretStore
  target:
    name: kargo-admin-creds
    template:
      engineVersion: v2
      data: 
        password: "{{.password}}"
  data:
  - secretKey: password
    remoteRef:
      key: kargo-admin-password
      property: password
---
# secret created by ESO, pushed into app specific namespace for use by kargo cred job
apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: gh-image-creds
spec:
  refreshInterval: 1h # How often to refresh the secret from AWS Secrets Manager
  # our actual secret store is in EKS cluster default NS
  secretStoreRef:
    name: aws-secretsmanager
    kind: ClusterSecretStore
  target:
    name: gh-image-creds
    template:
      engineVersion: v2
      metadata:
        labels:
          kargo.akuity.io/cred-type: image
      data: 
        repoURL: ghcr.io/akuity/sedemo-rollouts-app
        username: eddiewebb
        password: "{{.pat}}"
  data:
  - secretKey: pat
    remoteRef:
      key: kargo-pats
      property: eddies-gh-pat